# Unity

## 게임 오브젝트 / MonoBehaviour
#### DontDestroyOnLoad(gameObj)
- 게임 오브젝트를 씬이 변경되더라도 파괴되지 않게 함

#### 특수 메소드 어트리뷰트
- RuntimeInitializeOnLoadMethod
    - 런타임의 특정 시점에 불리게 할 수 있음
    - ` [RuntimeInitializeOnLoadMethod(RuntimeInitializeLoadType.BeforeSceneLoad)]`를 통해서 씬 로드 이전에 초기화를 하게 할 수 있음
    - 게임 인스턴스 싱글턴 등을 만들때 좋아보임

#### MonoBehaviour를 상속한 게임 오브젝트 이벤트 흐름
- Awake
    - 오브젝트 생성 시 실행 (가장 먼저 호출)
- Start
    - 첫 번째 Update() 전에 실행 (다른 오브젝트와 연계 가능)
- Update
    - 매 프레임 실행 (게임 로직)
- FixedUpdate
    - 물리 연산 전용 (고정 시간 간격)
- LateUpdate
    - Update() 이후 실행 (카메라 처리 등)
- 충돌 이벤트
    - OnCollision(물리 충돌) vs OnTrigger(트리거)
- 오브젝트 종료 이벤트
    - OnDisable(비활성화), OnDestroy(삭제)


---

## 스프라이트
#### 스프라이트 애니메이션
- 스프라이트 애셋 준비
    - [출처](https://m.blog.naver.com/kch8246/221012502429)
    1. 아틀라스 이미지를 애셋 폴더에 추가
    2. [Inspector] 에서 임포트 세팅 변경
        - Texture Type => Sprite (2D and UI)
        - Sprite Mode => Multiple
        - 우하단 [Sprite Editor] 버튼 클릭
    3. [Sprite Editor] > 상단 툴바 > [Slice]
        - Type => Automatic
        - 우하단 [Slice] 버튼 클릭
    4. 작업 완료 후 [Sprite Editor] > 상단 툴바 > [Apply]
- 간단한 Idle 애니메이션을 하는 스프라이트 캐릭터 만들기
    1. 애니메이션 창을 열어두기
        - [Window] > [Animation] > [Animation]
    2. 빈 스프라이트 오브젝트 생성
        -  [Hierarchy] > 우클릭 > [2D Objects] > [Sprites] > [Square]
    3. 2번에서 생성한 오브젝트 선택하고 애니메이션 창에서 [Create] 버튼을 눌러서 애니메이션 클립 생성
    4. 타임라인으로 애니메이션 작업
        - [Sprite Renderer] > [Sprite] 속성을 변경하여 키프레임 생성하면 됨
    5. 애니메이션 컨트롤러 생성하고, entry 이후 애니메이션 실행하게 하기
        - [Create] > [Animator Controller]
    6. 2번에서 만든 오브젝트에 [Animator] 컴포넌트 추가 및 5번에서 생성한 컨트롤러 연결

---

## UI
#### UI 위에 스프라이트 올리기
- [출처](https://m.blog.naver.com/inceleb/220687133326)
- 카메라를 하나 더 추가해서 처리한다.
    1. UI용 카메라 추가
        - [Hierarchy] > 우클릭 > [GameObject] > [Create Empty] > Camera 컴포넌트 추가
    2. 컬링 마스크 변경
        - [Inspector] > 카메라 컴포넌트
            - Culling Mask => UI
            - 다른 기본 메인 카메라는 Default
    3. UI 카메라와 캔버스 연결
        - [Hierarchy] > Canvas 게임 오브젝트 > [Inspector] > Canvas 컴포넌트
            - Render Mode => Screen Space - Camera
            - Render Camera => 1번으로 만든 UI 카메라 연결
    4. 카메라 컴포넌트의 Depth를 조절하여 렌더 순서 조정
        - Depth가 높을수록 위에 출력됨
        - 메인 카메라 배경에 UI가 모두 가려지는 경우 카메라 컴포넌트에서 `Clear Flags`를 `Don't Clear`로 변경

---

## Trouble Shooting
#### Newtonsoft Json을 사용할 수 없다.
- package manager를 이용해서 패키지를 추가해줘야 하나봄
    1. 유니티 에디터 상단 메뉴에서
    2. [windows] > [package manager] > [install package by name …]
    3. com.unity.nuget.newtonsoft-json


#### Immutable collection을 사용할 수 없다.
- [microsoft article](https://learn.microsoft.com/en-us/visualstudio/gamedev/unity/unity-scripting-upgrade?view=vs-2019)
    1. 유니티 에디터 상단 메뉴에서
    2. [Edit] > [Project Settings] > [Player] > [Other Settings]
    3. 팝업에서 [Configuration] > [Api Compatibitliy Level]
        - .NET 4.x